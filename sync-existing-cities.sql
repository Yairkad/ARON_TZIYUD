-- ================================================
-- סקריפט סנכרון רשימת ערים קיימת
-- ================================================
-- קובץ זה עוזר לך להעביר את רשימת הערים הקיימת שלך
-- למבנה החדש של 2 אנשי קשר לכל עיר
--
-- הוראות שימוש:
-- 1. ערוך את הטבלה למטה עם הנתונים שלך
-- 2. העתק והדבק ב-Supabase SQL Editor
-- 3. לחץ RUN
-- ================================================

-- ================================================
-- שלב 1: מחק ערים לדוגמה (אם קיימות)
-- ================================================
-- הסר את הפתיחה אם אתה רוצה למחוק את הערים לדוגמה
/*
DELETE FROM cities WHERE name IN ('ירושלים', 'תל אביב', 'חיפה');
*/

-- ================================================
-- שלב 2: הוסף את הערים שלך
-- ================================================
-- החלף את הדוגמאות למטה עם הנתונים שלך
-- פורמט:
-- ('שם העיר', 'שם מנהל 1', 'טלפון מנהל 1', 'שם מנהל 2 או NULL', 'טלפון מנהל 2 או NULL', 'קישור מפה או NULL', 'סיסמה')

INSERT INTO public.cities (name, manager1_name, manager1_phone, manager2_name, manager2_phone, location_url, password) VALUES
    -- דוגמה 1 - עם 2 מנהלים ומיקום
    ('ירושלים', 'יוסי כהן', '0501234567', 'דוד לוי', '0507654321', 'https://maps.google.com/?q=31.7683,35.2137', '1111'),

    -- דוגמה 2 - עם 2 מנהלים בלי מיקום
    ('תל אביב', 'דני שלום', '0502345678', 'משה גולן', '0508765432', NULL, '2222'),

    -- דוגמה 3 - עם מנהל אחד בלבד
    ('חיפה', 'אבי ישראל', '0503456789', NULL, NULL, 'https://maps.google.com/?q=32.7940,34.9896', '3333')

    -- הוסף עוד ערים כאן...
    -- ,('עיר נוספת', 'מנהל 1', '0501111111', NULL, NULL, NULL, 'סיסמה')

ON CONFLICT (name) DO UPDATE SET
    manager1_name = EXCLUDED.manager1_name,
    manager1_phone = EXCLUDED.manager1_phone,
    manager2_name = EXCLUDED.manager2_name,
    manager2_phone = EXCLUDED.manager2_phone,
    location_url = EXCLUDED.location_url,
    password = EXCLUDED.password,
    is_active = true;

-- ================================================
-- שלב 3: אימות
-- ================================================
-- בדוק שהערים נוספו בהצלחה
SELECT
    name AS "שם העיר",
    manager1_name AS "מנהל 1",
    manager1_phone AS "טלפון 1",
    manager2_name AS "מנהל 2",
    manager2_phone AS "טלפון 2",
    CASE WHEN location_url IS NOT NULL THEN '✅' ELSE '❌' END AS "יש מיקום",
    is_active AS "פעיל"
FROM cities
ORDER BY name;

-- ================================================
-- הערות חשובות
-- ================================================
-- 1. מספרי טלפון חייבים להיות בני 10 ספרות בדיוק
-- 2. שמות ערים חייבים להיות ייחודיים
-- 3. ON CONFLICT עדכן רשומות קיימות אם העיר כבר קיימת
-- 4. לאחר הוספת ערים, תצטרך לשייך ציוד קיים לערים
-- 5. ראה הקובץ database-multi-city.sql לשיוך ציוד והיסטוריה
-- ================================================
