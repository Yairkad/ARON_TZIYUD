<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>× ×™×”×•×œ ×”×©××œ×•×ª ×’×œ×’×œ×™× - ×”×“×’××”</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #1f2937; min-height: 100vh; }

    /* Navigation */
    .nav { background: #374151; padding: 10px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
    .nav-btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; }
    .nav-btn.active { background: #3b82f6; color: white; }
    .nav-btn:not(.active) { background: #4b5563; color: #d1d5db; }

    /* Screens */
    .screen { display: none; padding: 20px; max-width: 600px; margin: 0 auto; }
    .screen.active { display: block; }

    /* Cards */
    .card { background: #374151; border-radius: 12px; padding: 20px; margin-bottom: 15px; }
    .card-title { color: white; font-size: 18px; font-weight: 600; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }

    /* Form elements */
    label { color: #9ca3af; font-size: 14px; display: block; margin-bottom: 5px; }
    .required::after { content: ' *'; color: #ef4444; }
    input, select, textarea { width: 100%; padding: 12px; border: 1px solid #4b5563; border-radius: 8px; background: #1f2937; color: white; font-size: 16px; margin-bottom: 15px; }
    input:focus, select:focus, textarea:focus { outline: none; border-color: #3b82f6; }

    /* Buttons */
    .btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px; }
    .btn-primary { background: #3b82f6; color: white; }
    .btn-success { background: #10b981; color: white; }
    .btn-whatsapp { background: #25d366; color: white; }
    .btn-warning { background: #f59e0b; color: white; }
    .btn-danger { background: #ef4444; color: white; }
    .btn-secondary { background: #4b5563; color: white; }
    .btn:hover { opacity: 0.9; }
    .btn-full { width: 100%; justify-content: center; }

    /* Table */
    .table-container { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; min-width: 500px; }
    th { background: #4b5563; color: #d1d5db; padding: 12px 8px; text-align: right; font-size: 13px; }
    td { padding: 12px 8px; border-bottom: 1px solid #4b5563; color: white; font-size: 14px; }
    tr:hover { background: #4b5563; }

    /* Status badges */
    .badge { padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 600; }
    .badge-waiting { background: #fef3c7; color: #92400e; }
    .badge-signed { background: #d1fae5; color: #065f46; }
    .badge-returned { background: #e0e7ff; color: #3730a3; }
    .badge-overdue { background: #fee2e2; color: #991b1b; }

    /* Signature pad */
    .signature-container { background: white; border-radius: 8px; margin: 15px 0; overflow: hidden; }
    .signature-pad { width: 100%; height: 150px; border: 2px dashed #d1d5db; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #6b7280; cursor: crosshair; position: relative; }
    .signature-pad.signed { border-style: solid; border-color: #10b981; background: #f0fdf4; }
    .signature-pad canvas { position: absolute; top: 0; left: 0; }

    /* Info box */
    .info-box { background: #1e3a5f; border: 1px solid #3b82f6; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
    .info-box p { color: #93c5fd; font-size: 14px; line-height: 1.6; }

    /* Terms */
    .terms { background: #1f2937; border-radius: 8px; padding: 15px; margin: 15px 0; max-height: 200px; overflow-y: auto; }
    .terms h4 { color: #f59e0b; margin-bottom: 10px; }
    .terms p, .terms ul { color: #d1d5db; font-size: 14px; }
    .terms ul { padding-right: 20px; }
    .terms li { margin-bottom: 8px; }

    /* Checkbox */
    .checkbox-row { display: flex; align-items: flex-start; gap: 10px; margin: 15px 0; }
    .checkbox-row input { width: auto; margin: 0; margin-top: 3px; flex-shrink: 0; }
    .checkbox-row label { margin: 0; color: white; font-size: 14px; }

    /* Radio buttons */
    .radio-group { margin-bottom: 15px; }
    .radio-option { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background: #1f2937; border-radius: 8px; cursor: pointer; }
    .radio-option:hover { background: #374151; }
    .radio-option input { width: auto; margin: 0; }
    .radio-option label { margin: 0; color: white; cursor: pointer; }

    /* Stats */
    .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
    .stat { background: #4b5563; border-radius: 8px; padding: 15px; text-align: center; }
    .stat-num { font-size: 24px; font-weight: bold; color: white; }
    .stat-label { font-size: 12px; color: #9ca3af; margin-top: 5px; }

    /* Action buttons row */
    .action-row { display: flex; gap: 8px; flex-wrap: wrap; }
    .action-row .btn { padding: 6px 12px; font-size: 12px; }

    /* Loan details in table */
    .loan-info { font-size: 12px; color: #9ca3af; }

    /* Modal */
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 100; align-items: center; justify-content: center; padding: 20px; }
    .modal-overlay.active { display: flex; }
    .modal { background: #374151; border-radius: 12px; padding: 20px; max-width: 500px; width: 100%; max-height: 90vh; overflow-y: auto; }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .modal-title { color: white; font-size: 18px; font-weight: 600; }
    .modal-close { background: none; border: none; color: #9ca3af; font-size: 24px; cursor: pointer; }

    /* Success screen */
    .success-icon { font-size: 60px; text-align: center; margin: 20px 0; }
    .success-text { color: white; text-align: center; font-size: 18px; margin-bottom: 20px; }

    /* Filter tabs */
    .filter-tabs { display: flex; gap: 8px; margin-bottom: 15px; flex-wrap: wrap; }
    .filter-tab { padding: 8px 16px; border-radius: 20px; border: none; font-size: 13px; cursor: pointer; }
    .filter-tab.active { background: #3b82f6; color: white; }
    .filter-tab:not(.active) { background: #4b5563; color: #d1d5db; }

    /* Form row */
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    @media (max-width: 500px) {
      .form-row { grid-template-columns: 1fr; }
    }

    /* Section title */
    .section-title { color: #60a5fa; font-size: 16px; font-weight: 600; margin: 20px 0 15px 0; padding-bottom: 8px; border-bottom: 1px solid #4b5563; }

    /* Description box */
    .description-box { background: #1e3a5f; border: 1px solid #3b82f6; border-radius: 8px; padding: 15px; margin-bottom: 20px; }
    .description-box h3 { color: #60a5fa; margin-bottom: 10px; font-size: 16px; }
    .description-box p { color: #93c5fd; font-size: 14px; line-height: 1.6; margin-bottom: 8px; }
    .description-box ul { color: #93c5fd; font-size: 14px; padding-right: 20px; }
    .description-box li { margin-bottom: 5px; }
  </style>
</head>
<body>

<!-- Navigation -->
<nav class="nav">
  <button class="nav-btn active" onclick="showScreen('tracking')">ğŸ“Š ××¢×§×‘ ×”×©××œ×•×ª</button>
  <button class="nav-btn" onclick="showScreen('sign-form')">âœï¸ ×˜×•×¤×¡ ×œ×¤×•× ×”</button>
</nav>

<!-- Screen 1: Tracking Table (for station manager) -->
<div id="tracking" class="screen active">
  <div class="description-box">
    <h3>ğŸ“‹ ××¡×š ×–×” ×œ×× ×”×œ ×”×ª×—× ×”</h3>
    <p>×›××Ÿ ×ª×¨××” ××ª ×›×œ ×”×”×©××œ×•×ª ×•×ª×•×›×œ ×œ×¢×§×•×‘ ××—×¨×™:</p>
    <ul>
      <li>××™ ×—×ª× ×¢×œ ×”×˜×•×¤×¡ ×•××™ ×œ×</li>
      <li>××™×–×” ×¤×™×§×“×•×Ÿ ×”×•×©××¨</li>
      <li>×©×œ×™×—×ª ×ª×–×›×•×¨×•×ª ×‘×•×•××˜×¡××¤</li>
      <li>×¡×™××•×Ÿ ×’×œ×’×œ ×›"×”×•×—×–×¨"</li>
    </ul>
  </div>

  <div class="stats">
    <div class="stat">
      <div class="stat-num" style="color: #f59e0b;">3</div>
      <div class="stat-label">×××ª×™× ×™× ×œ×—×ª×™××”</div>
    </div>
    <div class="stat">
      <div class="stat-num" style="color: #10b981;">12</div>
      <div class="stat-label">××•×©××œ×™× (×—×ª×•××™×)</div>
    </div>
    <div class="stat">
      <div class="stat-num" style="color: #8b5cf6;">47</div>
      <div class="stat-label">×”×•×—×–×¨×• ×”×—×•×“×©</div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">ğŸ“Š ××¢×§×‘ ×”×©××œ×•×ª</div>

    <div class="filter-tabs">
      <button class="filter-tab active">×”×›×œ</button>
      <button class="filter-tab">â³ ×××ª×™×Ÿ ×œ×—×ª×™××”</button>
      <button class="filter-tab">âœ… ××•×©××œ</button>
      <button class="filter-tab">ğŸ”™ ×”×•×—×–×¨</button>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>×¤×•× ×”</th>
            <th>×’×œ×’×œ</th>
            <th>×¤×™×§×“×•×Ÿ</th>
            <th>×¡×˜×˜×•×¡</th>
            <th>×¤×¢×•×œ×•×ª</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <div>×™×•×¡×™ ×›×”×Ÿ</div>
              <div class="loan-info">050-1234567</div>
              <div class="loan-info">×”×™×•× 14:30</div>
            </td>
            <td>
              <div>A12</div>
              <div class="loan-info">×™×•× ×“××™ i25</div>
            </td>
            <td><span class="badge badge-signed">â‚ª500 ××–×•××Ÿ</span></td>
            <td><span class="badge badge-waiting">â³ ×××ª×™×Ÿ ×œ×—×ª×™××”</span></td>
            <td>
              <div class="action-row">
                <button class="btn btn-whatsapp" onclick="sendWhatsApp('×™×•×¡×™ ×›×”×Ÿ', '0501234567', 'ABC123')">ğŸ“±</button>
                <button class="btn btn-secondary" onclick="showReminder()">ğŸ””</button>
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <div>××©×” ×œ×•×™</div>
              <div class="loan-info">052-9876543</div>
              <div class="loan-info">×”×™×•× 12:15</div>
            </td>
            <td>
              <div>A15</div>
              <div class="loan-info">×˜×•×™×•×˜×” ×§×•×¨×•×œ×”</div>
            </td>
            <td><span class="badge badge-signed">â‚ª500 ×‘×™×˜</span></td>
            <td><span class="badge badge-signed">âœ… × ×—×ª×</span></td>
            <td>
              <div class="action-row">
                <button class="btn btn-success" onclick="markReturned()">ğŸ”™ ×”×•×—×–×¨</button>
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <div>×“×•×“ ××‘×¨×”×</div>
              <div class="loan-info">054-5555555</div>
              <div class="loan-info">××ª××•×œ 18:00</div>
            </td>
            <td>
              <div>23</div>
              <div class="loan-info">×××–×“×” 3</div>
            </td>
            <td><span class="badge badge-warning">×ª.×–.</span></td>
            <td><span class="badge badge-overdue">âš ï¸ ×œ× × ×—×ª× 24+ ×©×¢×•×ª</span></td>
            <td>
              <div class="action-row">
                <button class="btn btn-whatsapp" onclick="sendWhatsApp('×“×•×“ ××‘×¨×”×', '0545555555', 'DEF456')">ğŸ“±</button>
                <button class="btn btn-danger">ğŸ“</button>
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <div>×©×¨×” ×’×•×œ×Ÿ</div>
              <div class="loan-info">053-1111111</div>
              <div class="loan-info">08/12 09:00</div>
            </td>
            <td>
              <div>A18</div>
              <div class="loan-info">×§×™×” ×¡×¤×•×¨×˜××–'</div>
            </td>
            <td><span class="badge badge-returned">â‚ª500 ×”×•×—×–×¨</span></td>
            <td><span class="badge badge-returned">ğŸ”™ ×”×•×—×–×¨</span></td>
            <td>
              <div class="action-row">
                <button class="btn btn-secondary" onclick="showDetails()">ğŸ‘ï¸</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Screen 2: Sign Form (what the borrower sees when clicking WhatsApp link) -->
<div id="sign-form" class="screen">
  <div class="description-box">
    <h3>ğŸ“ ×˜×•×¤×¡ ×–×” ×œ×¤×•× ×” (××§×‘×œ ×”×’×œ×’×œ)</h3>
    <p>×”×¤×•× ×” ××§×‘×œ ×œ×™× ×§ ×‘×•×•××˜×¡××¤ ×•×××œ× ××ª ×”×˜×•×¤×¡ ×”×–×”.</p>
    <p>××—×¨×™ ×©×”×•× ×—×•×ª×, ×”×’×œ×’×œ ××¡×•××Ÿ ×›××•×©××œ ×¢× ×¤×¨×˜×™×•.</p>
  </div>

  <div class="card">
    <div class="card-title">ğŸ› ×”×©××œ×ª ×¦××™×’ - ×¡× ×™×£ ×™×“×™×“×™× ×™×¨×•×©×œ×™×</div>
    <p style="color: #9ca3af; margin-bottom: 15px; font-size: 14px;">×˜×•×¤×¡ ×œ×”×©××œ×ª ×’×œ×’×œ ××ª×—× ×ª ×”×©××œ×ª ×¦××™×’×™× - ×™×“×™×“×™× ×™×¨×•×©×œ×™×</p>

    <!-- Intro text -->
    <div class="info-box" style="margin-bottom: 20px;">
      <p>×¢××•×ª×ª ×™×“×™×“×™× ×¡×™×•×¢ ×‘×“×¨×›×™× ×¡× ×™×£ ×™×¨×•×©×œ×™× ×××¤×©×¨×ª ×œ×©××•×œ ×¦××™×’×™× ×œ×¤×¨×§ ×–××Ÿ ××•×’×‘×œ ×¢×œ ×× ×ª ×œ×¢×–×•×¨ ×‘××§×¨×™× ×‘×”× ××™×Ÿ ×¤× ×¦'×¨×™×•×ª ×¤×ª×•×—×•×ª, ×•×œ× × ×™×ª×Ÿ ×œ×‘×¦×¢ ×ª×™×§×•×Ÿ ×–×× ×™.</p>
      <p style="margin-top: 10px;">×× ×• ××‘×§×©×™× ×œ×”×—×–×™×¨ ××ª ×”×¦××™×’ ×‘×”×§×“× ×”××¤×©×¨×™ ×•×¢×“ 72 ×©×¢×•×ª ×××•×¢×“ ×”×”×©××œ×”, ×¢×œ ×× ×ª ×©× ×•×›×œ ×œ×”××©×™×š ×•×œ×¡×™×™×¢ ×œ×× ×©×™× × ×•×¡×¤×™×.</p>
      <p style="margin-top: 10px;">××¨×’×•×Ÿ ×™×“×™×“×™× ×¤×•×¢×œ ×‘×”×ª× ×“×‘×•×ª ××œ××”, ×•×ª×¨×•××•×ª ×¢×•×–×¨×•×ª ×œ××¨×’×•×Ÿ ×‘×¨×›×™×©×ª ×¦×™×•×“ - <a href="https://yedidim-il.org" target="_blank" style="color: #60a5fa;">× ×™×ª×Ÿ ×œ×ª×¨×•× ×›××Ÿ</a></p>
      <p style="margin-top: 10px;">×œ×”×¦×˜×¨×¤×•×ª ×œ××¢×¦××” - ×¤× ×• ×œ×”× ×”×œ×ª ×”×¡× ×™×£ ××• <a href="https://yedidim-il.org" target="_blank" style="color: #60a5fa;">×‘×§×™×©×•×¨ ×–×”</a></p>
    </div>

    <div class="section-title">×¤×¨×˜×™× ××™×©×™×™×</div>

    <div class="form-row">
      <div>
        <label class="required">×©× ×¤×¨×˜×™</label>
        <input type="text" id="sign-first-name" placeholder="×™×©×¨××œ">
      </div>
      <div>
        <label class="required">×©× ××©×¤×—×”</label>
        <input type="text" id="sign-last-name" placeholder="×™×©×¨××œ×™">
      </div>
    </div>

    <label class="required">×ª×¢×•×“×ª ×–×”×•×ª</label>
    <input type="text" id="sign-id" placeholder="123456789" maxlength="9">

    <label class="required">×˜×œ×¤×•×Ÿ</label>
    <input type="tel" id="sign-phone" placeholder="050-1234567">

    <label class="required">×›×ª×•×‘×ª ××’×•×¨×™×</label>
    <input type="text" id="sign-address" placeholder="×¨×—×•×‘ ×”×¨×¦×œ 1, ×™×¨×•×©×œ×™×">

    <div class="section-title">×¤×¨×˜×™ ×”×”×©××œ×”</div>

    <label class="required">×ª××¨×™×š ×”×©××œ×”</label>
    <input type="date" id="sign-date">

    <label class="required">××¡×¤×¨ ×¦××™×’ (×¨×§ ×¦××™×’×™× ×–××™× ×™× ×‘×ª×—× ×”)</label>
    <select id="sign-wheel-serial">
      <option value="">×‘×—×¨ ×¦××™×’...</option>
      <!-- ×‘×¤×•×¢×œ ×”×¨×©×™××” ×ª×™×˜×¢×Ÿ ×“×™× ××™×ª ××”×ª×—× ×” - ×¨×§ ×’×œ×’×œ×™× ×–××™× ×™× -->
      <option value="A12">A12 - 15" | 4Ã—100 | ×–××™×Ÿ âœ…</option>
      <option value="A14">A14 - 16" | 5Ã—114.3 | ×–××™×Ÿ âœ…</option>
      <option value="A18">A18 - 17" | 5Ã—112 | ×–××™×Ÿ âœ…</option>
      <option value="23">23 - 15" | 4Ã—108 | ×“×•× ××˜ | ×–××™×Ÿ âœ…</option>
      <option value="40">40 - 16" | 5Ã—100 | ×–××™×Ÿ âœ…</option>
    </select>
    <p style="color: #6b7280; font-size: 12px; margin-top: -10px; margin-bottom: 15px;">
      ğŸ“‹ ××•×¦×’×™× ×¨×§ ×¦××™×’×™× ×–××™× ×™× ×‘×ª×—× ×” ×–×•
    </p>

    <label class="required">×“×’× ×”×¨×›×‘</label>
    <input type="text" id="sign-vehicle" placeholder="×™×•× ×“××™ i25">

    <div class="section-title">×¤×™×§×“×•×Ÿ</div>

    <label class="required">××•×¤×Ÿ ×ª×©×œ×•× ×”×¤×™×§×“×•×Ÿ</label>
    <div class="radio-group">
      <div class="radio-option">
        <input type="radio" name="deposit" id="deposit-cash" value="cash">
        <label for="deposit-cash">â‚ª500 ××–×•××Ÿ</label>
      </div>
      <div class="radio-option">
        <input type="radio" name="deposit" id="deposit-bit" value="bit">
        <label for="deposit-bit">â‚ª500 ×‘×‘×™×˜ ×œ-050-3044088</label>
      </div>
      <div class="radio-option">
        <input type="radio" name="deposit" id="deposit-id" value="id">
        <label for="deposit-id">×¤×™×§×“×•×Ÿ ×ª×¢×•×“×ª ×–×”×•×ª (×‘××™×©×•×¨ ×× ×”×œ)</label>
      </div>
      <div class="radio-option">
        <input type="radio" name="deposit" id="deposit-license" value="license">
        <label for="deposit-license">×¤×™×§×“×•×Ÿ ×¨×™×©×™×•×Ÿ × ×”×™×’×” (×‘××™×©×•×¨ ×× ×”×œ)</label>
      </div>
    </div>

    <label>×”×¢×¨×•×ª × ×•×¡×¤×•×ª (××•×¤×¦×™×•× ×œ×™)</label>
    <textarea id="sign-notes" rows="2" placeholder="×¤×¨×˜×™× × ×•×¡×¤×™×..."></textarea>

    <div class="section-title">×ª× ××™ ×”×©××œ×” ×•×”×ª×—×™×™×‘×•×ª</div>

    <div class="terms">
      <p><strong>×ª×§× ×•×Ÿ ×”×©××œ×ª ×’×œ×’×œ:</strong></p>
      <ol style="padding-right: 20px; margin-top: 10px;">
        <li style="margin-bottom: 10px;">×”×¤×•× ×” ××ª×—×™×™×‘ ×œ×”×—×–×™×¨ ××ª ×”×¦××™×’ ×‘×ª×•×š <strong>72 ×©×¢×•×ª</strong>, ×•×œ×”×©××™×¨ ×›×¤×§×“×•×Ÿ 500 ×©"×— ×‘××–×•××Ÿ ××• ×‘×‘×™×˜ ×œ××¡×¤×¨ 050-3044088.</li>
        <li style="margin-bottom: 10px;">×”×¤×•× ×” ×™×§×‘×œ ×—×–×¨×” ××ª ×”×¤×§×“×•×Ÿ ×‘×¢×ª ×”×—×–×¨×ª ×”×¦××™×’. ×‘××™×“×” ×•×”×¦××™×’ ×œ× ×™×•×—×–×¨ ×‘×ª×•×š 72 ×©×¢×•×ª, ×¡×›×•× ×”×›×¡×£ ×™×•×¢×‘×¨ ×›×ª×¨×•××” ×œ×™×“×™×“×™×.</li>
        <li style="margin-bottom: 10px;"><strong>×”×¤×•× ×” ××‘×™×Ÿ ×©×–×”×• ×ª×™×§×•×Ÿ ×—×™×¨×•× ×‘×œ×‘×“!</strong> ×•×”×’×œ×’×œ ×¢×©×•×™ ×œ×”×™×•×ª ×‘××™×“×” ××¢×˜ ×©×•× ×”/×œ×¤×’×•×¢ ×‘×™×¦×™×‘×•×ª ×”×¨×›×‘ ×•×œ×›×Ÿ ××ª×—×™×™×‘ ×œ× ×œ× ×”×•×’ ×‘××”×™×¨×•×ª ××¢×œ 80 ×§×"×© ×•×›×Ÿ ×©×œ× ×ª×”×™×” ×œ×• ×©×•× ×ª×œ×•× ×” ×¢×œ ×”×¡×™×•×¢ ×©×§×™×‘×œ.</li>
        <li style="margin-bottom: 10px;">×‘××§×¨×™× ×—×¨×™×’×™× × ×™×ª×Ÿ ×œ×”××¨×™×š ××ª ×–××Ÿ ×”×”×©××œ×” ×¢×“ 5 ×™××™×, ×‘××™×©×•×¨ ×× ×”×œ ×”×ª×—× ×” ××• ×¡×’"× ×”×ª×—× ×”.</li>
        <li style="margin-bottom: 10px;">×‘××§×¨×™× ×—×¨×™×’×™× (×‘××™×©×•×¨ ×× ×”×œ/×¡×’"× ×”×ª×—× ×”) × ×™×ª×Ÿ ×œ×”×¤×§×™×“ ×›×¢×¨×‘×•×Ÿ ×ª×¢×•×“×” ××–×”×” ×‘××§×•× ×¤×§×“×•×Ÿ ×›×¡×¤×™.</li>
      </ol>
    </div>

    <div class="checkbox-row">
      <input type="checkbox" id="agree-terms">
      <label for="agree-terms" class="required">×§×¨××ª×™ ××ª ×”×ª× ××™× ×•×× ×™ ××¡×›×™×/×” ×œ×”×</label>
    </div>

    <label>×—×ª×™××”</label>
    <div class="signature-container">
      <div class="signature-pad" id="sig-pad">
        <span id="sig-placeholder">×—×ª××• ×›××Ÿ ×¢× ×”××¦×‘×¢</span>
        <canvas id="sig-canvas"></canvas>
      </div>
    </div>
    <button class="btn btn-secondary" onclick="clearSignature()" style="margin-bottom: 15px; padding: 8px 16px; font-size: 14px;">ğŸ—‘ï¸ × ×§×” ×—×ª×™××”</button>

    <button class="btn btn-success btn-full" onclick="submitSignature()">
      âœ… ×©×œ×™×—×ª ×”×˜×•×¤×¡
    </button>
  </div>
</div>

<!-- Modal: Signature Success -->
<div class="modal-overlay" id="modal-signed">
  <div class="modal">
    <div class="success-icon">âœ…</div>
    <div class="success-text">×ª×•×“×”! ×”×˜×•×¤×¡ × ×©×œ×— ×‘×”×¦×œ×—×”</div>
    <p style="color: #9ca3af; text-align: center; margin-bottom: 20px;">
      ×¤×¨×˜×™ ×”×”×ª×—×™×™×‘×•×ª × ×©××¨×• ×‘××¢×¨×›×ª.<br>
      ×”×¦××™×’ ×¡×•××Ÿ ×›××•×©××œ ×¢×œ ×©××š.<br><br>
      <strong style="color: #f59e0b;">âš ï¸ × × ×œ×”×—×–×™×¨ ××ª ×”×¦××™×’ ×ª×•×š 72 ×©×¢×•×ª!</strong>
    </p>
    <button class="btn btn-primary btn-full" onclick="closeModal('modal-signed')">
      ×¡×’×•×¨
    </button>
  </div>
</div>

<script>
  // Set today's date as default
  document.getElementById('sign-date').valueAsDate = new Date();

  // Signature pad
  const canvas = document.getElementById('sig-canvas');
  const ctx = canvas.getContext('2d');
  const sigPad = document.getElementById('sig-pad');
  const placeholder = document.getElementById('sig-placeholder');
  let isDrawing = false;
  let hasSigned = false;

  function resizeCanvas() {
    const rect = sigPad.getBoundingClientRect();
    canvas.width = rect.width;
    canvas.height = rect.height;
    ctx.strokeStyle = '#10b981';
    ctx.lineWidth = 3;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
  }
  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);

  function getPos(e) {
    const rect = canvas.getBoundingClientRect();
    if (e.touches) {
      return { x: e.touches[0].clientX - rect.left, y: e.touches[0].clientY - rect.top };
    }
    return { x: e.clientX - rect.left, y: e.clientY - rect.top };
  }

  function startDrawing(e) {
    e.preventDefault();
    isDrawing = true;
    hasSigned = true;
    placeholder.style.display = 'none';
    sigPad.classList.add('signed');
    const pos = getPos(e);
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
  }

  function draw(e) {
    if (!isDrawing) return;
    e.preventDefault();
    const pos = getPos(e);
    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();
  }

  function stopDrawing() {
    isDrawing = false;
  }

  canvas.addEventListener('mousedown', startDrawing);
  canvas.addEventListener('mousemove', draw);
  canvas.addEventListener('mouseup', stopDrawing);
  canvas.addEventListener('mouseleave', stopDrawing);
  canvas.addEventListener('touchstart', startDrawing);
  canvas.addEventListener('touchmove', draw);
  canvas.addEventListener('touchend', stopDrawing);

  function clearSignature() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    hasSigned = false;
    placeholder.style.display = 'block';
    sigPad.classList.remove('signed');
  }

  // Navigation
  function showScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
    event.target.classList.add('active');
  }

  // WhatsApp functions
  function sendWhatsApp(name, phone, loanId) {
    const message = `×©×œ×•× ${name}! ğŸ‘‹

×§×™×‘×œ×ª ×’×œ×’×œ ×—×™×œ×•×£ ××ª×—× ×ª ×™×“×™×“×™× ×™×¨×•×©×œ×™×.

ğŸ“ × × ×œ××œ× ×•×œ×—×ª×•× ×¢×œ ×˜×•×¤×¡ ×”×”×ª×—×™×™×‘×•×ª:
https://aron-tziyud.vercel.app/wheels/sign/${loanId}

ğŸ”„ ×™×© ×œ×”×—×–×™×¨ ××ª ×”×’×œ×’×œ ×ª×•×š 7 ×™××™× ×œ×ª×—× ×”.

×ª×•×“×” ×¨×‘×”! ğŸ™
×™×“×™×“×™× - ×¡×™×•×¢ ×‘×“×¨×›×™×`;

    const cleanPhone = phone.replace(/\D/g, '');
    const israelPhone = cleanPhone.startsWith('0') ? '972' + cleanPhone.slice(1) : cleanPhone;

    window.open(`https://wa.me/${israelPhone}?text=${encodeURIComponent(message)}`, '_blank');
  }

  // Submit signature
  function submitSignature() {
    const agreed = document.getElementById('agree-terms').checked;
    const deposit = document.querySelector('input[name="deposit"]:checked');

    if (!document.getElementById('sign-first-name').value) {
      alert('× × ×œ××œ× ×©× ×¤×¨×˜×™');
      return;
    }
    if (!document.getElementById('sign-id').value || document.getElementById('sign-id').value.length < 9) {
      alert('× × ×œ××œ× ×ª×¢×•×“×ª ×–×”×•×ª (9 ×¡×¤×¨×•×ª)');
      return;
    }
    if (!document.getElementById('sign-phone').value) {
      alert('× × ×œ××œ× ××¡×¤×¨ ×˜×œ×¤×•×Ÿ');
      return;
    }
    if (!deposit) {
      alert('× × ×œ×‘×—×•×¨ ××•×¤×Ÿ ×ª×©×œ×•× ×¤×™×§×“×•×Ÿ');
      return;
    }
    if (!hasSigned) {
      alert('× × ×œ×—×ª×•× ×¢×œ ×”×˜×•×¤×¡');
      return;
    }
    if (!agreed) {
      alert('× × ×œ××©×¨ ××ª ×ª× ××™ ×”×”×©××œ×”');
      return;
    }

    document.getElementById('modal-signed').classList.add('active');
  }

  // Close modal
  function closeModal(modalId) {
    document.getElementById(modalId).classList.remove('active');
  }

  // Mark as returned
  function markReturned() {
    alert('×”×’×œ×’×œ ×¡×•××Ÿ ×›"×”×•×—×–×¨" âœ…\n×”×¤×™×§×“×•×Ÿ ×™×•×—×–×¨ ×œ×œ×§×•×—.');
  }

  // Show reminder
  function showReminder() {
    if (confirm('×œ×©×œ×•×— ×ª×–×›×•×¨×ª ×‘×•×•××˜×¡××¤?')) {
      sendWhatsApp('×™×•×¡×™ ×›×”×Ÿ', '0501234567', 'ABC123');
    }
  }

  // Show details
  function showDetails() {
    alert('×¤×¨×˜×™ ×”×”×©××œ×”:\n\n×©×: ×©×¨×” ×’×•×œ×Ÿ\n×ª.×–.: 123456789\n×˜×œ×¤×•×Ÿ: 053-1111111\n×’×œ×’×œ: A18\n×¨×›×‘: ×§×™×” ×¡×¤×•×¨×˜××–\'\n×¤×™×§×“×•×Ÿ: â‚ª500 ××–×•××Ÿ\n\n×ª××¨×™×š ×”×©××œ×”: 08/12/2024\n×ª××¨×™×š ×—×ª×™××”: 08/12/2024\n×ª××¨×™×š ×”×—×–×¨×”: 09/12/2024\n\nâœ… ×”×›×œ ×ª×§×™×Ÿ - ×”×¤×™×§×“×•×Ÿ ×”×•×—×–×¨');
  }
</script>

</body>
</html>
